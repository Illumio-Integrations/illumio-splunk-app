<dashboard version="1.1" script="invoke_ar_action.js" stylesheet="custom_ar_button.css">
  <label>Firewall Tampering Host</label>
  <description>Hostname lookup may result in multiple records. Please select the hostname to investigate or quarantine.</description>
  <row>
    <panel>
      <table id="quarantineHost">
        <search id="quarantineSearch">
          <query>| savedsearch Illumio_Firewall_Tempering | search $fqdn$ $leader_fqdn$ | rename created_hostname as hostname | join type=outer hostname max=0 [| inputlookup illumio_workload_mapping_lookup | table hostname, label, workload_uuid, os_id] | table _time, hostname, label, workload_uuid, os_id, pce_fqdn | rex field=hostname "(?&lt;hostname_q&gt;.*?)(\..*|$)(\..*|$)" | eval Quarantine=workload_uuid + ","+ pce_fqdn, data_file=1 | rename workload_uuid as "Workload UUID", hostname as "Host Name", pce_fqdn as "PCE" | stats values(label) as Label, values(os_id) as "OS Name", latest(_time) as Time by "Workload UUID", "Host Name", Quarantine, data_file, PCE | join [| rest splunk_server=local /services/authentication/current-context | eval show_quarantine=if(roles="illumio_quarantine_workload",1,0),data_file=1 | table show_quarantine,data_file ] | eval Quarantine=Quarantine +","+ show_quarantine, Investigate='Host Name', Time= strftime(Time, "%Y-%m-%d %H:%M:%S %Z") | table Time, Label, "Host Name", "OS Name", PCE, Quarantine, Investigate</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <fields>Time, Label, "Host Name", "OS Name", PCE, Quarantine, Investigate</fields>
        <option name="count">10</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</dashboard>