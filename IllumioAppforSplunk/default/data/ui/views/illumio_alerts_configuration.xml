<form version="1.1" script="illumio_alert.js" stylesheet="illumio_alert.css" theme="light">
  <label>Alert Configuration</label>
  <fieldset submitButton="false" autoRun="false">
    <input type="dropdown" token="alert_type" searchWhenChanged="true">
      <label>Choose Alert Configuration to create or update</label>
      <choice value="system_health">PCE System Health Events</choice>
      <choice value="ruleset_update">Rule Set Writing/Update</choice>
      <choice value="sec_rule_change">Rule Writing Update</choice>
      <choice value="affected_workload">Policy Provisioning</choice>
      <choice value="workload_labeling">Workload Labeling</choice>
      <change>
        <condition value="system_health">
          <set token="system_health">system_health</set>
          <unset token="ruleset_update"></unset>
          <unset token="affected_workload"></unset>
          <unset token="sec_rule_change"></unset>
          <unset token="workload_labeling"></unset>
        </condition>
        <condition value="ruleset_update">
          <set token="ruleset_update">ruleset_update</set>
          <set token="ruleset_change"></set>
          <unset token="system_health"></unset>
          <unset token="affected_workload"></unset>
          <unset token="sec_rule_change"></unset>
          <unset token="workload_labeling"></unset>
        </condition>
        <condition value="sec_rule_change">
          <set token="sec_rule_change">sec_rule_change</set>
          <unset token="affected_workload"></unset>
          <unset token="system_health"></unset>
          <unset token="ruleset_update"></unset>
          <unset token="workload_labeling"></unset>
        </condition>
        <condition value="affected_workload">
          <set token="affected_workload">affected_workload</set>
          <unset token="sec_rule_change"></unset>
          <unset token="system_health"></unset>
          <unset token="ruleset_update"></unset>
          <unset token="workload_labeling"></unset>
        </condition>
        <condition value="workload_labeling">
          <set token="workload_labeling">workload_labeling</set>
          <unset token="sec_rule_change"></unset>
          <unset token="system_health"></unset>
          <unset token="ruleset_update"></unset>
          <unset token="affected_workload"></unset>
        </condition>
      </change>
      <default>system_health</default>
      <initialValue>system_health</initialValue>
    </input>
    <input type="dropdown" id="alerts" token="alert_name" depends="$ruleset_update$" searchWhenChanged="true">
      <label>Alert Name</label>
      <choice value="">New Alert</choice>
      <fieldForLabel>title</fieldForLabel>
      <fieldForValue>title</fieldForValue>
      <search>
        <query>| rest /servicesNS/-/-/saved/searches $ruleset_change$ | search eai:acl.app=IllumioAppforSplunk AND description="ruleset update alert" | dedup title | eval title = substr(title, 24) | table title</query>
      </search>
      <default></default>
    </input>
  </fieldset>
  <row>
    <panel depends="$system_health$">
      <html>
          <table class="table_style">
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_title">
                    <span>
                <b>PCE System Health Events</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_info">
                    <span>
                <b>Alert name: Illumio_PCE_Health_Alert</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_info">
                    <span>
                When any PCE Node generates a new system_health message whose severity meets these conditions:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="sev_warning"/>
                  </td>
                  <td class="td_input_style">
                        <span class="span_style" title="disk_space >= 95% or disk_inodes >= 95% or memory >= 95% or cpu >= 95% for more than 5 minutes or cluster=degraded (>=2 minutes) or cluster=down (&lt;2 minutes) or replication lag >= 30 seconds">
                          <b>Severity=Warning</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="sev_error"/>
                  </td>
                  <td class="td_input_style">
                      <span class="span_style" title="cluster=down (>=2 minutes)">
                          <b>Severity=Error</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="sev_critical"/>
                  </td>
                  <td  class="td_input_style">
                      <span class="span_style" title="cluster=failed">
                          <b>Severity=Critical</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="submitbutton" type="button" id="submit_button_system_health" value="Save"/>
                      </span>
                  </td>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="resetbutton" type="button" id="reset_button_system_health" value="Reset"/>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="2" class="info_message" id="illumio_system_health_info_msg">
                    <span>For further information on System Health, refer to
                    <a target="_blank" href="https://support.illumio.com/documentation/19.3.0/Illumio_ASP_19.3.0_PCE_Operations.htm#IllumioAdaptiveSecurityPlatform19.3.0PCEOperationsGuide-PCEHealthMonitoringwithsyslog">PCE Operations Guide</a>
                    </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="2" style="text-align:center" id="illumio_system_health_status_msg"/>
                  <td class="td_side_style"/>
              </tr>
          </table>
      </html>
    </panel>
    <panel depends="$ruleset_update$">
      <html>
          <table class="table_style">
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_title">
                    <span>
                <b>Rule Set Writing/Update</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style" style="padding-left:50px">
                    <span class="span_style">
                        <b>Alert Name : illumio_ruleset_update_</b>
                    </span>
                      <input class="input_style" type="text" id="alert_name_id" style="width: auto !important;"/>
                      <font color="red">*</font>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                If the PCE generates any of the following events:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style" style="padding-right:40px">
                   <input class="input_style" type="checkbox" id="ruleset_create">
                      <div style="text-align: center;"><b>Draft Rule Set Create</b></div>
                    </input>
                  </td>
                  <td class="td_input_style">
                    <input class="input_style" style="width:80% !important" type="checkbox" id="ruleset_update">
                      <div style="text-align: center; width:145px"><b>Draft Rule Set Update</b></div>
                    </input>
                  </td>
                  <td class="td_input_style">
                    <input class="input_style" type="checkbox" id="ruleset_delete">
                      <div style="text-align: center"><b>Draft Rule Set Delete</b></div>
                    </input>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                And, the RuleSet has a scope that contains any of the following:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="all_app"/>
                  </td>
                  <td colspan="2" class="td_input_style">
                      <span class="span_style">
                          <b>All Applications</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="all_loc"/>
                  </td>
                  <td colspan="2" class="td_input_style">
                      <span class="span_style">
                          <b>All Locations</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="all_env"/>
                  </td>
                  <td colspan="2" class="td_input_style">
                      <span class="span_style">
                          <b>All Environments</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="custom_label"/>
                  </td>
                  <td colspan="2" class="td_input_style">
                      <span class="span_style">
                          <b>Selected Labels</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr id="label_filter">
                <td class="td_side_style"/>
                <td class="td_input_style"/>
                <td colspan="2">
                  <div class="multiselectInput">
                    <input id="custom_label_id" placeholder="User selected labels (multi-select)"/>
                    <div id="custom_label_id_searchdata">Waiting for data...</div>
                  </div>
                  <span class="join_text">Join multiple labels with</span>
                  <input type="radio" id="ruleset_AND" name="ruleset_join" value="AND"/>
                    <label class="radio_label" for="AND">AND</label>
                  
                  <input type="radio" id="ruleset_OR"  name="ruleset_join" value="OR" checked="checked"/>
                  <label class="radio_label" for="OR">OR</label>
                </td>
                <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="submitbutton" type="button" id="submit_button_ruleset_update" value="Save"/>
                      </span>
                  </td>
                  <td class="td_input_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="resetbutton" type="button" id="reset_button_ruleset_update" value="Reset"/>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" class="info_message" id="illumio_system_health_info_msg">
                    <span>For further information on Rule Sets, please refer to <a target="_blank" href="https://support.illumio.com/documentation/19.3.0/ug/Default.htm#Topics/Security_policy/about_rulesets.htm%3FTocPath%3DRulesets%7C_____0">PCE Web Console User Guide</a>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" style="text-align:center" id="illumio_ruleset_update_status_msg"/>
                  <td class="td_side_style"/>
              </tr>
          </table>
      </html>
    </panel>
    <panel depends="$sec_rule_change$">
      <html>
          <table class="table_style">
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_title">
                    <span>
                <b>Rule Writing Update</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                <b>Alert name: Illumio_Rule_Update_Alert</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                If the PCE generates any of the following events:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                <td class="td_side_style"/>
                <td style="padding-left: 10px;">
                  <input class="input_style" style="width:70% !important" type="checkbox" id="sec_rule_create">
                    <div style="text-align: center;width: 126px;"><b>Draft Rule Create</b></div>
                  </input>
                </td>
                <td style="padding-left: 40px;">
                  <input class="input_style" style="width:90% !important" type="checkbox" id="sec_rule_update">
                    <div style="text-align: center; width:115px"><b>Draft Rule Update</b></div>
                  </input>
                </td>
                <td style="padding-left: 50px;">
                  <input class="input_style" type="checkbox" id="sec_rule_delete">
                    <div style="text-align: center;"><b>Draft Rule Delete</b></div>
                  </input>
                </td>
                <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                And, Rule Providers or Consumers include any of the following:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td class="td_input_style"/>
                  <td class="td_input_style"/>
                  <td class="td_input_style"/>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="all_worklaods"/>
                  </td>
                  <td colspan="2" class="td_input_style">
                      <span class="span_style">
                          <b>All Workloads</b>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="all_services"/>
                  </td>
                  <td class="td_input_style">
                      <span class="span_style">
                          <b>Selected Services</b>
                      </span>
                  </td>
                  <td>
                    <div class="multiselectInput">
                        <input id="services_id" placeholder="Multi-select Service Names"/>
                      <div id="services_id_searchdata" style="display: none;">Waiting for data...</div>
                    </div>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                   <td style="padding-left: 10px;">
                      <input class="input_style" type="checkbox" id="any_consumers"/>
                  </td>
                  <td class="td_input_style">
                      <span class="span_style">
                          <b>Selected IPLists</b>
                      </span>
                  </td>
                  <td>
                    <div class="multiselectInput">
                      <input id="ip_lists_id" placeholder="Multi-select IPList Names"/>
                      <div id="ip_lists_id_searchdata">Waiting for data...</div>
                    </div>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                <td class="td_side_style"/>
                <td class="td_input_style"/>
                <td class="td_input_style"/>
                <td>
                  <span class="join_text">Join multiple labels with</span>
                  <input type="radio" id="rule_AND" name="rule_join" value="AND"/>
                  <label class="radio_label" for="AND">AND</label>
                  <input type="radio" id="rule_OR" name="rule_join" value="OR" checked="checked"/>
                  <label class="radio_label" for="OR">OR</label>
                </td>
                <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="submitbutton" type="button" id="submit_button_sec_rule_change" value="Save"/>
                      </span>
                  </td>
                  <td class="td_input_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="resetbutton" type="button" id="reset_button_sec_rule_change" value="Reset"/>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" class="info_message" id="illumio_sec_rule_change_info_msg">
                    <span>For further information on Rules, please refer to <a target="_blank" href="https://support.illumio.com/documentation/19.3.0/ug/Default.htm#Topics/Security_policy/rule_types.htm">PCE Web Console User Guide</a>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" style="text-align:center" id="illumio_sec_rule_change_status_msg"/>
                  <td class="td_side_style"/>
              </tr>
          </table>
      </html>
    </panel>
    <panel depends="$affected_workload$">
      <html>
          <table class="table_style">
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_title">
                    <span>
                <b>Policy Provisioning</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_info">
                    <span>
                <b>Alert name: Illumio_Policy_Provisioning_Alert</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="2" class="td_input_style panel_info">
                    <span>
                If the PCE generates a Policy Provision Event with number of online Workloads exceeding
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                    <span class="span_style" style="padding-left:40px">
                      <b>Threshold (X count or Y%)</b>
                      <font color="red">*</font>
                    </span>
                  </td>
                  <td style="padding-left: 30px;">
                      <input class="input_style" type="text" id="workloads_threshold" style="width:auto !important"/>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td class="td_input_style"/>
                  <td class="td_input_style"/>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="submitbutton" type="button" id="submit_button_affected_workload" value="Save"/>
                      </span>
                  </td>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="resetbutton" type="button" id="reset_button_affected_workload" value="Reset"/>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="2" class="info_message" id="illumio_affected_workload_info_msg">
                    <span>For further information on Policy Provisioning, please refer to <a target="_blank" href="https://support.illumio.com/documentation/19.3.0/ug/Default.htm#Topics/Security_policy/provisioning.htm">PCE Web Console User Guide</a>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="2" style="text-align:center;" id="illumio_affected_workload_status_msg"/>
                  <td class="td_side_style"/>
              </tr>
          </table>
      </html>
    </panel>
    <panel depends="$workload_labeling$">
      <html>
          <table class="table_style">
            <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_title">
                    <span>
                <b>Workload Labeling</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                <b>Alert name: Illumio_Workload_Labeling_Alert</b>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                If the PCE generates any of the following events:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                <td class="td_side_style"/>
                <td>
                  <input class="input_style" type="checkbox" id="workload_added">
                    <div style="text-align: center;width: 110px; padding:5px 0 0 50px"><b>Workload Added</b></div>
                  </input>
                </td>
                <td style="padding-left: 10px;">
                  <input class="input_style" style="width:80% !important; padding-left:20px" type="checkbox" id="workload_updated">
                    <div style="text-align: center; width:120px"><b>Workload Update</b></div>
                  </input>
                </td>
                <td>
                  <input class="input_style" type="checkbox" id="workload_deleted">
                    <div style="text-align: center; padding-top:5px"><b>Workload Deleted</b></div>
                  </input>
                </td>
                <td class="td_side_style"/>
              </tr>
              <tr class="tr_input_style">
                  <td class="td_side_style"/>
                  <td colspan="3" class="td_input_style panel_info">
                    <span>
                And the labels specified for the workload include:
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td style="padding:10px 0 0 10px;">
                    <input class="input_style" type="checkbox" id="workload_label"/>
                    <span class="span_style" style="padding:5px 0 0 77px;">
                        <b>Labels</b>
                    </span>
                  </td>
                  <td colspan="2" style="padding-top:10px">
                    <div class="multiselectInput">
                        <input id="workload_label_id" placeholder="Multi-select label list"/>
                      <div id="workload_label_id_searchdata" style="display: none;">Waiting for data...</div>
                    </div>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                <td class="td_side_style"/>
                <td class="td_input_style"/>
                <td colspan="2">
                  <span class="join_text" style="padding-top:0px ">Join multiple labels with</span>
                  <input type="radio" id="workload_AND" name="join" value="AND"/>
                  <label class="radio_label" for="AND">AND</label>
                  <input type="radio" id="workload_OR" name="join" value="OR" checked="checked"/>
                  <label class="radio_label" for="OR">OR</label>
                </td>
                <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="submitbutton" type="button" id="submit_button_workload_label_update" value="Save"/>
                      </span>
                  </td>
                  <td class="td_input_style"/>
                  <td class="td_input_style">
                      <span class="span_style">
                          <input class="resetbutton" type="button" id="reset_button_workload_label_update" value="Reset"/>
                      </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <td colspan="3" class="info_message" id="illumio_workload_label_update_info_msg">
                    <span>For more information on Workloads and labels, please refer to <a target="_blank" href="https://support.illumio.com/documentation/19.3.0/ug/Default.htm#Topics/Labels/label_a_workload.htm">PCE Web Console User Guide</a>
              </span>
                  </td>
                  <td class="td_side_style"/>
              </tr>
              <tr>
                  <td class="td_side_style"/>
                  <center>
                  <td colspan="3" style="text-align:center;" id="illumio_workload_label_update_status_msg"/>
                  </center>
                  <td class="td_side_style"/>
              </tr>
          </table>
      </html>
    </panel>
  </row>
</form>